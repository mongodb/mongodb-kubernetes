apiVersion: mongodb.com/v1
kind: MongoDBSearch
metadata:
  name: mdb-sh
spec:
  logLevel: DEBUG
  source:
    mongodb:
      name: mdb-sh
    replicas: 2
  security:
    tls:
      certificateKeySecretRef:
        name: mdb-sh-search-cert
      ca:
        name: mdb-sh-ca
  lb:
    mode: External
    external:
      sharded:
        endpoints:
          # These endpoints point to the Envoy proxy services on port 27029.
          # NAMESPACE placeholder is replaced with actual namespace by the test fixture.
          - shardName: mdb-sh-0
            endpoint: mdb-sh-mongot-mdb-sh-0-proxy-svc.NAMESPACE.svc.cluster.local:27029
          - shardName: mdb-sh-1
            endpoint: mdb-sh-mongot-mdb-sh-1-proxy-svc.NAMESPACE.svc.cluster.local:27029
